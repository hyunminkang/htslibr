HTSLIB_DIR=htslib

.PHONY: all htslib create_lib_dir copy_so

LIB_DIR=${R_PACKAGE_DIR}/lib

all: $(SHLIB)

htslib:
	$(warning "now building libhts.so")
	cd $(HTSLIB_DIR) && $(MAKE) -f "${R_HOME}/etc/Makeconf" -f Makefile
	$(warning "now printing out files")
	ls -a *.so.*

$(SHLIB): htslib
	$(warning "now in ${LIB_DIR}")
	mkdir -p ${LIB_DIR}
	cd $(HTSLIB_DIR) && cp libhts.so libhts.so.2to3part5 libhts.a ${LIB_DIR}
	cp libhts.so libhts.so.2to3part5
	cp libhts.so libhts.so.2

PKG_LIBS= -lhts -L${LIB_DIR} -Wl,-rpath=${LIB_DIR} -L${HTSLIB_DIR}
CXX_STD = CXX11
PKG_CPPFLAGS = -Ihtslib -DSTRICT_R_HEADERS
